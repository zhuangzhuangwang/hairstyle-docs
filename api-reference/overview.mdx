---
title: 'API概述'
description: 'AILabTools API文档介绍'
---

<Note>
  欢迎使用AILabTools API文档。本文档提供了基于稳定扩散模型的发型编辑Pro功能的完整API参考。
</Note>

## 欢迎

我们提供了两种方式来构建API文档：[OpenAPI](https://mintlify.com/docs/api-playground/openapi/setup) 和 [MDX组件](https://mintlify.com/docs/api-playground/mdx/configuration)。我们使用以下OpenAPI规范。

<Card
  title="AILabTools API端点"
  icon="image"
  href="https://github.com/ailabtools/hairstyle-cn-docs/blob/main/openapi.json"
>
  查看OpenAPI规范文件
</Card>

## 认证

所有API端点都使用自定义请求头进行认证，认证配置在规范文件中定义。

```json
"security": [
  {
    "apiKeyAuth": []
  }
]
```

## API端点

我们的API包含以下主要端点：

### 发型编辑Pro
- **POST** `/api/portrait/effects/hairstyle-editor-pro` - 基于稳定扩散模型，智能编辑人像图片中的发型和颜色

### 异步任务查询
- **GET** `/api/common/query-async-task-result` - 查询异步任务的处理结果，获取最终的图片处理结果

### 人脸分析
- **POST** `/api/portrait/analysis/face-analysis` - 分析图片中的人脸信息，包括人脸数量、位置、角度等，用于前端验证

## 图片要求

- **图像格式**: `PNG` `JPG` `JPEG`
- **图像大小**: 不超过3MB
- **图像分辨率**: 大于200x200px，小于1999x1999px
- **人脸要求**: 
  - 图片中必须包含一个人脸
  - 人脸占比应大于图片的20%
  - 人脸角度不应超过45度

## 图片验证示例

<table>
  <tr>
    <th style={{'text-align':'center'}}>图片有效性</th>
    <th style={{'text-align':'center'}}>示例图片</th>
    <th style={{'text-align':'center'}}>无效原因</th>
  </tr>
  <tr>
    <td style={{'text-align':'center'}}>✅ 有效</td>
    <td>
      <div style={{'display':'flex','flex-wrap':'wrap','justify-content':'space-around'}}>
        <div style={{'max-width':'100px','margin':'5px'}}>
          <img alt="有效示例1" src="https://ai-resource.ailabtools.com/hairstyle-changer-pro/valid-invalid-examples/valid-1.webp" />
        </div>
        <div style={{'max-width':'100px','margin':'5px'}}>
          <img alt="有效示例2" src="https://ai-resource.ailabtools.com/hairstyle-changer-pro/valid-invalid-examples/valid-2.webp" />
        </div>
        <div style={{'max-width':'100px','margin':'5px'}}>
          <img alt="有效示例3" src="https://ai-resource.ailabtools.com/hairstyle-changer-pro/valid-invalid-examples/valid-3.webp" />
        </div>
        <div style={{'max-width':'100px','margin':'5px'}}>
          <img alt="有效示例4" src="https://ai-resource.ailabtools.com/hairstyle-changer-pro/valid-invalid-examples/valid-4.webp" />
        </div>      
      </div>
    </td>
    <td style={{'text-align':'center'}}>-</td>
  </tr>
  <tr>
    <td style={{'text-align':'center'}} rowspan="5">❌ 无效</td>
    <td>
      <div style={{'display':'flex','flex-wrap':'wrap','justify-content':'space-around'}}>
        <div style={{'max-width':'100px','margin':'5px'}}>
          <img alt="无效示例1" src="https://ai-resource.ailabtools.com/hairstyle-changer-pro/valid-invalid-examples/no-face-1.webp" />
        </div>
        <div style={{'max-width':'100px','margin':'5px'}}>
          <img alt="无效示例2" src="https://ai-resource.ailabtools.com/hairstyle-changer-pro/valid-invalid-examples/no-face-2.webp" />
        </div>    
      </div>
    </td>
    <td style={{'text-align':'center'}}>无人脸</td>
  </tr>
  <tr>
    <td>
      <div style={{'display':'flex','flex-wrap':'wrap','justify-content':'space-around'}}>
        <div style={{'max-width':'100px','margin':'5px'}}>
          <img alt="无效示例3" src="https://ai-resource.ailabtools.com/hairstyle-changer-pro/valid-invalid-examples/face-incomplete-1.webp" />
        </div>
        <div style={{'max-width':'100px','margin':'5px'}}>
          <img alt="无效示例4" src="https://ai-resource.ailabtools.com/hairstyle-changer-pro/valid-invalid-examples/face-incomplete-2.webp" />
        </div>    
      </div>
    </td>
    <td style={{'text-align':'center'}}>人脸不完整</td>
  </tr>
  <tr>
    <td>
      <div style={{'display':'flex','flex-wrap':'wrap','justify-content':'space-around'}}>
        <div style={{'max-width':'100px','margin':'5px'}}>
          <img alt="无效示例5" src="https://ai-resource.ailabtools.com/hairstyle-changer-pro/valid-invalid-examples/face-blocked-1.webp" />
        </div>
        <div style={{'max-width':'100px','margin':'5px'}}>
          <img alt="无效示例6" src="https://ai-resource.ailabtools.com/hairstyle-changer-pro/valid-invalid-examples/face-blocked-2.webp" />
        </div>    
      </div>
    </td>
    <td style={{'text-align':'center'}}>人脸被遮挡</td>
  </tr>
  <tr>
    <td>
      <div style={{'display':'flex','flex-wrap':'wrap','justify-content':'space-around'}}>
        <div style={{'max-width':'100px','margin':'5px'}}>
          <img alt="无效示例7" src="https://ai-resource.ailabtools.com/hairstyle-changer-pro/valid-invalid-examples/face-small-1.webp" />
        </div>
        <div style={{'max-width':'100px','margin':'5px'}}>
          <img alt="无效示例8" src="https://ai-resource.ailabtools.com/hairstyle-changer-pro/valid-invalid-examples/face-small-2.webp" />
        </div>    
      </div>
    </td>
    <td style={{'text-align':'center'}}>人脸占比过小</td>
  </tr>
  <tr>
    <td>
      <div style={{'display':'flex','flex-wrap':'wrap','justify-content':'space-around'}}>
        <div style={{'max-width':'100px','margin':'5px'}}>
          <img alt="无效示例9" src="https://ai-resource.ailabtools.com/hairstyle-changer-pro/valid-invalid-examples/face-big-1.webp" />
        </div>
        <div style={{'max-width':'100px','margin':'5px'}}>
          <img alt="无效示例10" src="https://ai-resource.ailabtools.com/hairstyle-changer-pro/valid-invalid-examples/face-big-2.webp" />
        </div>    
      </div>
    </td>
    <td style={{'text-align':'center'}}>人脸过大无法编辑发型</td>
  </tr>
</table>

## 发型分类

<Tabs>
  <Tab title="男士发型">
    <table>
      <tr>
        <th>发型代码</th>
        <th>描述</th>
      </tr>
      <tr><td>BuzzCut</td><td>寸头</td></tr>
      <tr><td>UnderCut</td><td>底切发型</td></tr>
      <tr><td>Pompadour</td><td>蓬巴杜发型</td></tr>
      <tr><td>SlickBack</td><td>背头</td></tr>
      <tr><td>CurlyShag</td><td>卷发蓬松发型</td></tr>
      <tr><td>WavyShag</td><td>波浪蓬松发型</td></tr>
      <tr><td>FauxHawk</td><td>假鹰发型</td></tr>
      <tr><td>Spiky</td><td>刺猬头</td></tr>
      <tr><td>CombOver</td><td>梳背头</td></tr>
      <tr><td>HighTightFade</td><td>高紧渐变</td></tr>
      <tr><td>ManBun</td><td>男士发髻</td></tr>
      <tr><td>Afro</td><td>爆炸头</td></tr>
      <tr><td>LowFade</td><td>低渐变</td></tr>
      <tr><td>UndercutLongHair</td><td>底切长发</td></tr>
      <tr><td>TwoBlockHaircut</td><td>两段式发型</td></tr>
      <tr><td>TexturedFringe</td><td>纹理刘海</td></tr>
      <tr><td>BluntBowlCut</td><td>钝角碗盖头</td></tr>
      <tr><td>LongWavyCurtainBangs</td><td>长波浪窗帘刘海</td></tr>
      <tr><td>MessyTousled</td><td>凌乱蓬松</td></tr>
      <tr><td>CornrowBraids</td><td>玉米辫</td></tr>
      <tr><td>LongHairTiedUp</td><td>长发扎起</td></tr>
      <tr><td>Middle-parted</td><td>中分发型</td></tr>
    </table>
  </Tab>
  <Tab title="女士发型">
    <table>
      <tr>
        <th>发型代码</th>
        <th>描述</th>
      </tr>
      <tr><td>ShortPixieWithShavedSides</td><td>短精灵头剃边</td></tr>
      <tr><td>ShortNeatBob</td><td>短整洁波波头</td></tr>
      <tr><td>DoubleBun</td><td>双发髻</td></tr>
      <tr><td>Updo</td><td>盘发</td></tr>
      <tr><td>Spiked</td><td>刺猬头</td></tr>
      <tr><td>bowlCut</td><td>碗盖头</td></tr>
      <tr><td>Chignon</td><td>发髻</td></tr>
      <tr><td>PixieCut</td><td>精灵头</td></tr>
      <tr><td>SlickedBack</td><td>背头</td></tr>
      <tr><td>LongCurly</td><td>长卷发</td></tr>
      <tr><td>CurlyBob</td><td>卷发波波头</td></tr>
      <tr><td>StackedCurlsInShortBob</td><td>短波波头堆叠卷发</td></tr>
      <tr><td>SidePartCombOverHairstyleWithHighFade</td><td>侧分梳背头高渐变</td></tr>
      <tr><td>WavyFrenchBobVibesfrom1920</td><td>1920年代波浪法式波波头</td></tr>
      <tr><td>BobCut</td><td>波波头</td></tr>
      <tr><td>ShortTwintails</td><td>短双马尾</td></tr>
      <tr><td>ShortCurlyPixie</td><td>短卷发精灵头</td></tr>
      <tr><td>LongStraight</td><td>长直发</td></tr>
      <tr><td>LongWavy</td><td>长波浪发</td></tr>
      <tr><td>FishtailBraid</td><td>鱼尾辫</td></tr>
      <tr><td>TwinBraids</td><td>双辫子</td></tr>
      <tr><td>Ponytail</td><td>马尾辫</td></tr>
      <tr><td>Dreadlocks</td><td>脏辫</td></tr>
      <tr><td>Cornrows</td><td>玉米辫</td></tr>
      <tr><td>ShoulderLengthHair</td><td>齐肩直发</td></tr>
      <tr><td>LooseCurlyAfro</td><td>松散卷发爆炸头</td></tr>
      <tr><td>LongTwintails</td><td>长双马尾</td></tr>
      <tr><td>LongHimeCut</td><td>长姬式发型</td></tr>
      <tr><td>BoxBraids</td><td>盒辫</td></tr>
    </table>
  </Tab>
  <Tab title="发色">
    <table>
      <tr>
        <th>发色代码</th>
        <th>描述</th>
      </tr>
      <tr><td>blonde</td><td>金发</td></tr>
      <tr><td>platinumBlonde</td><td>铂金金发</td></tr>
      <tr><td>brown</td><td>棕色</td></tr>
      <tr><td>lightBrown</td><td>浅棕色</td></tr>
      <tr><td>blue</td><td>蓝色</td></tr>
      <tr><td>lightBlue</td><td>浅蓝色</td></tr>
      <tr><td>purple</td><td>紫色</td></tr>
      <tr><td>lightPurple</td><td>浅紫色</td></tr>
      <tr><td>pink</td><td>粉色</td></tr>
      <tr><td>black</td><td>黑色</td></tr>
      <tr><td>white</td><td>白色</td></tr>
      <tr><td>grey</td><td>灰色</td></tr>
      <tr><td>silver</td><td>银色</td></tr>
      <tr><td>red</td><td>红色</td></tr>
      <tr><td>orange</td><td>橙色</td></tr>
      <tr><td>green</td><td>绿色</td></tr>
      <tr><td>gradient</td><td>渐变</td></tr>
      <tr><td>multicolored</td><td>多色</td></tr>
      <tr><td>darkBlue</td><td>深蓝色</td></tr>
      <tr><td>burgundy</td><td>酒红色</td></tr>
      <tr><td>darkGreen</td><td>深绿色</td></tr>
    </table>
  </Tab>
</Tabs>

## 异步API流程

我们的API采用异步处理模式：

1. **提交任务**: 调用发型编辑API提交处理请求，返回`task_id`
2. **查询结果**: 使用`task_id`查询处理结果
3. **状态轮询**: 定期查询直到任务完成

## 示例代码

<Tabs>
  <Tab title="cURL">
    ```bash
    # 1. 提交发型编辑任务
    curl --request POST \
      --url https://www.ailabapi.com/api/portrait/effects/hairstyle-editor-pro \
      --header 'ailabapi-api-key: YOUR_API_KEY' \
      --form 'task_type=async' \
      --form 'auto=1' \
      --form 'image=@/path/to/your/image.jpg' \
      --form 'hair_style=BuzzCut' \
      --form 'color=blonde' \
      --form 'image_size=2'

    # 2. 查询任务结果
    curl --request GET \
      --url 'https://www.ailabapi.com/api/common/query-async-task-result?task_id=YOUR_TASK_ID' \
      --header 'ailabapi-api-key: YOUR_API_KEY'
    ```
  </Tab>
  <Tab title="JavaScript">
    ```javascript
    // 1. 提交发型编辑任务
    const formData = new FormData();
    formData.append('task_type', 'async');
    formData.append('auto', '1');
    formData.append('image', imageFile);
    formData.append('hair_style', 'BuzzCut');
    formData.append('color', 'blonde');
    formData.append('image_size', '2');

    const response = await fetch('https://www.ailabapi.com/api/portrait/effects/hairstyle-editor-pro', {
      method: 'POST',
      headers: {
        'ailabapi-api-key': 'YOUR_API_KEY'
      },
      body: formData
    });

    const result = await response.json();
    const taskId = result.task_id;

    // 2. 轮询查询任务结果
    const checkResult = async (taskId) => {
      const resultResponse = await fetch(`https://www.ailabapi.com/api/common/query-async-task-result?task_id=${taskId}`, {
        headers: {
          'ailabapi-api-key': 'YOUR_API_KEY'
        }
      });
      
      const resultData = await resultResponse.json();
      
      if (resultData.task_status === 2) {
        // 任务完成，获取图片URL
        console.log('处理完成:', resultData.data.images);
        return resultData.data.images;
      } else if (resultData.task_status === 1) {
        // 处理中，继续轮询
        setTimeout(() => checkResult(taskId), 5000);
      } else {
        // 排队中，继续轮询
        setTimeout(() => checkResult(taskId), 5000);
      }
    };

    checkResult(taskId);
    ```
  </Tab>
  <Tab title="Python">
    ```python
    import requests
    import time

    # 1. 提交发型编辑任务
    url = "https://www.ailabapi.com/api/portrait/effects/hairstyle-editor-pro"
    headers = {"ailabapi-api-key": "YOUR_API_KEY"}
    
    with open("image.jpg", "rb") as f:
        files = {"image": f}
        data = {
            "task_type": "async",
            "auto": "1",
            "hair_style": "BuzzCut",
            "color": "blonde",
            "image_size": "2"
        }
        
        response = requests.post(url, headers=headers, files=files, data=data)
        result = response.json()
        task_id = result["task_id"]

    # 2. 轮询查询任务结果
    def check_result(task_id):
        url = f"https://www.ailabapi.com/api/common/query-async-task-result?task_id={task_id}"
        
        while True:
            response = requests.get(url, headers=headers)
            result = response.json()
            
            if result["task_status"] == 2:
                # 任务完成
                print("处理完成:", result["data"]["images"])
                return result["data"]["images"]
            elif result["task_status"] in [0, 1]:
                # 排队中或处理中，继续轮询
                time.sleep(5)
            else:
                print("任务失败")
                break

    check_result(task_id)
    ```
  </Tab>
</Tabs>

<Tip>
  <a href="https://www.ailabtools.com/portrait-hairstyle-editing-pro-example" target="_blank">
    👉 在线体验 👈
  </a>
  如果你想看到实际效果，请访问体验页面进行试用。
</Tip>
